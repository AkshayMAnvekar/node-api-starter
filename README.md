## Node API Starter [![CircleCI](https://circleci.com/gh/lorenzopicoli/node-api-starter.svg?style=svg)](https://circleci.com/gh/lorenzopicoli/node-api-starter)
[![Dependencies](https://david-dm.org/lorenzopicoli/node-api-starter.svg)](https://david-dm.org/lorenzopicoli/node-api-starter)
[![codecov](https://codecov.io/gh/lorenzopicoli/node-api-starter/branch/master/graph/badge.svg)](https://codecov.io/gh/lorenzopicoli/node-api-starter)
[![Code Climate](https://codeclimate.com/github/lorenzopicoli/node-api-starter/badges/gpa.svg)](https://codeclimate.com/github/lorenzopicoli/node-api-starter)

## Stack
- [Koa2](https://github.com/koajs/koa)
- [Knex](https://github.com/tgriesser/knex)
- [Bookshelf](https://github.com/tgriesser/bookshelf/)
- [PostgreSQL](https://www.postgresql.org/)
- Node > 7.6.0
- [Babel (stage-0)](https://github.com/babel/babel)
- [Mocha](https://github.com/mochajs/mocha/)
- [JSONDoc](http://jsondoc.org/)

## Gettings started

Clone the repository:
```
git clone https://github.com/lorenzopicoli/node-api-starter.git
```
Navigate to the repo folder and install the dependencies:
```
npm i
```
You can make sure the code is working by running the server on development mode:
```
âžœ npm run dev
```
You should get back:
```
> node-starter@1.0.0 dev /Users/lorenzopicoli/WebDev/node-api-boilerplate
> NODE_ENV=development ./node_modules/.bin/nodemon index.js

[nodemon] 1.11.0
[nodemon] to restart at any time, enter `rs`
[nodemon] watching: *.*
[nodemon] starting `node index.js`
Server running on 5000
```

## Creating new modules

Let's call it `places`:
```
# Create the module folder
mkdir src/modules/places
touch src/modules/places/controller.js
touch src/modules/places/router.js

# Create the bookshelf model
touch src/models/places.js

# Create the database migration
touch src/models/places.js
knex migrate:make create_places_table

# Run the new migration
npm run db:migrate
```


## NPM scripts

### Start the server on live mode (and migrate the database)
```
npm start
```

### Start the server for development (live reload)
```
npm run dev
```

### Before commit (lint and execute tests)
```
npm run commit
```

### Generate documentation
```
npm run docs
```

### Run tests
```
npm test
```


## Documentation
API documentation is written inline and generated by [jsondoc](http://apidocjs.com/).

Example: https://lorenzopicoli.github.io/node-api-starter


## Migrations & Seeding

### Generate new migration
```
knex migrate:make migration_name
```

### Run migrations
```
knex migrate:latest
```

### Roll back migration

```
knex migrate:rollback
```

### Run seeds
```sh
# development or production environment
NODE_ENV=development knex seed:run
```

See knex [docs](http://knexjs.org/#Installation-migrations) for details

## License
MIT
